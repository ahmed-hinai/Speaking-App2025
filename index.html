<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Speaking Coach ‚Äî Units 1‚Äì8 (no 7)</title>
  <style>
    /* ==== Option B: Light, clean, soft shadows ==== */
    :root{
      --bg:#ffffff; --text:#1f2937; --muted:#4b5563;
      --card:#ffffff; --card-border:#e5e7eb; --soft:#f5f7fb;
      --primary:#2563eb; --primary-ink:#ffffff; --accent:#3b82f6;
      --warn-bg:#fff8e6; --warn-border:#f4d38c; --warn-text:#8a5b00;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:linear-gradient(180deg,#f8fafc 0%, #f3f4f6 100%);
      color:var(--text);
    }
    header{padding:28px 16px 8px; text-align:center}
    h1{margin:0 0 6px; font-weight:700; letter-spacing:.2px}
    .sub{margin:0; color:var(--muted); font-size:14px}
    main{max-width:980px; margin:24px auto; padding:0 16px}

    /* Pills / controls */
    .row{display:flex; flex-wrap:wrap; gap:12px; margin-bottom:12px}
    .pill{
      background:var(--card);
      padding:10px 12px; border-radius:12px;
      display:flex; align-items:center; gap:10px;
      border:1px solid var(--card-border);
      box-shadow:0 1px 1px rgba(0,0,0,.02);
    }
    label{color:var(--muted); font-size:13px}
    select,button,input{
      appearance:none; border:1px solid var(--card-border); outline:none;
      background:#fff; color:var(--text);
      padding:9px 12px; border-radius:10px; font-size:14px;
    }
    input{min-width:160px}
    button{cursor:pointer; border:0; background:var(--primary); color:var(--primary-ink)}
    button:hover{filter:brightness(0.98)}
    button.ghost{background:#eef2ff; color:#1e40af; border:1px solid #dbeafe}
    button.ghost:hover{background:#e0e7ff}

    /* Cards */
    .card{
      background:var(--card);
      border:1px solid var(--card-border);
      border-radius:14px; padding:16px 18px; margin-bottom:16px;
      box-shadow:0 8px 20px rgba(2,6,23,.06);
    }

    /* Prompt tags */
    .targets{margin-top:10px; display:flex; flex-wrap:wrap; gap:8px}
    .badge{
      padding:6px 10px; border-radius:999px; background:var(--soft);
      border:1px solid var(--card-border); color:#374151; font-size:12px
    }

    /* Recorder & meter */
    .audio-bar{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:6px}
    .status{font-size:13px; color:var(--muted)}
    .meter{width:140px; height:10px; border-radius:6px; background:#eef2f7; border:1px solid var(--card-border); overflow:hidden}
    .meter > div{height:100%; background:var(--accent); width:0%}
    .timer{font-variant-numeric:tabular-nums; background:#f8fafc; border:1px solid var(--card-border); padding:6px 10px; border-radius:10px}

    .hidden{display:none}
    .fb-two{
      background:#f8fafc; border:1px solid var(--card-border);
      border-radius:12px; padding:12px
    }
    .tag{
      display:inline-block; margin-right:8px; margin-top:6px; padding:4px 8px; font-size:12px;
      border-radius:999px; border:1px solid var(--card-border); background:#ffffff; color:#334155
    }

    /* Mic help */
    .helpbar{
      background:var(--warn-bg); border:1px solid var(--warn-border); color:var(--warn-text);
      padding:10px 12px; border-radius:10px; font-size:13px; display:none; margin-bottom:10px
    }

    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; color:#1f2937}
    details > summary{cursor:pointer; color:#1e40af}
    a#dlLink{padding:9px 12px; border-radius:10px; text-decoration:none; border:1px solid #dbeafe; color:#1e40af; background:#eef2ff}
    a#dlLink:hover{background:#e0e7ff}
  </style>
</head>
<body>
  <header>
    <h1>AI Speaking Coach</h1>
    <p class="sub">Units 1‚Äì8 (excluding 7) ‚Ä¢ Easy / Medium / Hard ‚Ä¢ Mic recording + playback ‚Ä¢ Two-line feedback</p>
  </header>

  <main>
    <!-- Mic help / permissions -->
    <div id="micHelp" class="helpbar">
      Microphone is blocked or unavailable. In Chrome: click the lock icon ‚Üí Site settings ‚Üí Allow Microphone, then reload. On iPhone: open Settings ‚Üí Safari ‚Üí Microphone ‚Üí Allow.
    </div>

    <!-- Student metadata -->
    <div class="row">
      <div class="pill"><label>Name</label><input id="studentName" placeholder="e.g., Ahmed Al-H."></div>
      <div class="pill"><label>ID</label><input id="studentId" placeholder="e.g., 2414062"></div>
      <div class="pill"><label>Group</label><input id="studentGroup" placeholder="e.g., 405 / 406"></div>
    </div>

    <!-- Unit / Level / Prompt controls -->
    <div class="row">
      <div class="pill">
        <label for="unitSelect">Unit</label>
        <select id="unitSelect"></select>
      </div>
      <div class="pill">
        <label for="levelSelect">Level</label>
        <select id="levelSelect">
          <option value="easy">Easy</option>
          <option value="medium" selected>Medium</option>
          <option value="hard">Hard</option>
        </select>
      </div>
      <div class="pill">
        <button id="loadPromptBtn">Next prompt</button>
      </div>
    </div>

    <!-- Prompt + targets -->
    <section class="card">
      <h2 id="promptTitle" style="margin:.2rem 0 .4rem 0;">Prompt</h2>
      <p id="promptText" class="sub">Choose unit + level, then click ‚ÄúNext prompt‚Äù.</p>
      <div id="targetsBox" class="targets"></div>
    </section>

    <!-- Recorder -->
    <section class="card">
      <h3 style="margin-top:0">Record your answer</h3>
      <div class="audio-bar">
        <button id="recBtn">üéôÔ∏è Start</button>
        <button id="stopBtn" class="ghost" disabled>‚èπ Stop</button>
        <span class="timer" id="timer">00:00</span>
        <span id="recStatus" class="status">Mic: idle</span>
        <div class="meter"><div id="meterFill"></div></div>
        <button id="playBtn" class="ghost" disabled>‚ñ∂Ô∏è Play</button>
        <a id="dlLink" class="hidden" download="recording.webm">‚§ì Download</a>
        <audio id="player" class="hidden" controls></audio>
      </div>
    </section>

    <!-- Feedback -->
    <section id="feedback" class="card hidden">
      <h3 style="margin-top:0">Feedback</h3>
      <div class="fb-two">
        <p><strong>What you did well:</strong> <span id="fbGood"></span></p>
        <p><strong>Next step:</strong> <span id="fbNext"></span></p>
        <div class="tag" id="fbCefr"></div>
        <div class="tag mono" id="fbStats"></div>
      </div>
    </section>

    <!-- Actions -->
    <div class="row">
      <div class="pill"><button id="getFbBtn">Get Feedback</button></div>
      <div class="pill"><button id="submitBtn" class="ghost">Submit (to Sheets) ‚Äî not connected</button></div>
      <div class="pill"><button id="clearBtn" class="ghost">Clear</button></div>
    </div>

    <!-- Attempt preview (copy or use for webhook later) -->
    <section class="card">
      <details>
        <summary>Attempt data (preview)</summary>
        <pre id="attemptPreview" class="mono">{}</pre>
        <button id="copyBtn" class="ghost">Copy</button>
      </details>
      <p class="sub">Submit is a placeholder. We‚Äôll wire it to Google Sheets (Make.com / Apps Script) next.</p>
    </section>
  </main>

  <script src="script.js?v=light-b"></script>
</body>
</html>
