<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Speaking Coach ‚Äî Units 1‚Äì8 (no 7)</title>
  <style>
    :root{
      --bg:#0b1020; --panel:#121a36; --text:#e8eefc; --muted:#a8b3d9;
      --accent:#6aa0ff; --good:#3ecf8e; --warn:#ffcc66; --bad:#ff7a7a;
      --card:#0f1630; --ghost:#26325e;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;
      background:radial-gradient(1200px 600px at 10% -10%, #1a2552 0%, #0b1020 60%);
      color:var(--text);
    }
    header{padding:24px 20px 8px; text-align:center}
    h1{margin:0 0 6px; font-size:1.8rem}
    .sub{margin:0; color:var(--muted)}
    main{max-width:980px; margin:24px auto; padding:0 16px}
    .row{display:flex; flex-wrap:wrap; gap:12px; margin-bottom:12px}
    .pill{background:var(--panel); padding:10px 12px; border-radius:14px; display:flex; align-items:center; gap:10px}
    label{color:var(--muted)}
    select,button,input{
      appearance:none; border:none; outline:none;
      background:var(--card); color:var(--text);
      padding:10px 12px; border-radius:12px; font-size:14px;
    }
    input{min-width:160px}
    button{cursor:pointer}
    button:hover{filter:brightness(1.06)}
    button.ghost{background:var(--ghost)}
    .card{
      background:linear-gradient(180deg,#111a3a,#0e1631);
      border:1px solid #223062; border-radius:16px; padding:16px 18px; margin-bottom:16px;
      box-shadow:0 12px 28px rgba(0,0,0,0.35);
    }
    .targets{margin-top:8px; display:flex; flex-wrap:wrap; gap:6px}
    .badge{padding:6px 10px; border-radius:999px; background:#1b2652; border:1px dashed #32447e; color:#c7d4ff; font-size:12px}
    .audio-bar{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:6px}
    .status{font-size:13px; color:var(--muted)}
    .meter{width:120px; height:10px; border-radius:6px; background:#0b122b; border:1px solid #223062; overflow:hidden}
    .meter > div{height:100%; background:var(--accent); width:0%}
    .timer{font-variant-numeric:tabular-nums; background:#0b122b; border:1px solid #223062; padding:6px 10px; border-radius:10px}
    .hidden{display:none}
    .fb-two{background:#0b122b; border:1px solid #223062; border-radius:12px; padding:10px 12px}
    .tag{
      display:inline-block; margin-right:8px; margin-top:6px; padding:4px 8px; font-size:12px;
      border-radius:999px; border:1px solid #223062; background:#0b122b; color:#d8e2ff
    }
    .helpbar{
      background:#3a2d0e; border:1px solid #6a571f; color:#ffe6b3;
      padding:8px 12px; border-radius:10px; font-size:13px; display:none; margin-bottom:10px
    }
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px}
  </style>
</head>
<body>
  <header>
    <h1>AI Speaking Coach</h1>
    <p class="sub">Units 1‚Äì8 (excluding 7) ‚Ä¢ Easy / Medium / Hard ‚Ä¢ Mic recording + playback ‚Ä¢ Two-line feedback</p>
  </header>

  <main>
    <!-- Mic help / permissions -->
    <div id="micHelp" class="helpbar">
      Microphone is blocked or unavailable. In Chrome: click the lock icon ‚Üí Site settings ‚Üí Allow Microphone, then reload. On iPhone: use Safari ‚Üí Settings ‚Üí Microphone ‚Üí Allow.
    </div>

    <!-- Student metadata -->
    <div class="row">
      <div class="pill"><label>Name</label><input id="studentName" placeholder="e.g., Ahmed Al-H."></div>
      <div class="pill"><label>ID</label><input id="studentId" placeholder="e.g., 2414062"></div>
      <div class="pill"><label>Group</label><input id="studentGroup" placeholder="e.g., 405 / 406"></div>
    </div>

    <!-- Unit / Level / Prompt controls -->
    <div class="row">
      <div class="pill">
        <label for="unitSelect">Unit</label>
        <select id="unitSelect"></select>
      </div>
      <div class="pill">
        <label for="levelSelect">Level</label>
        <select id="levelSelect">
          <option value="easy">Easy</option>
          <option value="medium" selected>Medium</option>
          <option value="hard">Hard</option>
        </select>
      </div>
      <div class="pill">
        <button id="loadPromptBtn">Next prompt</button>
      </div>
    </div>

    <!-- Prompt + targets -->
    <section class="card">
      <h2 id="promptTitle">Prompt</h2>
      <p id="promptText" class="sub">Choose unit + level, then click ‚ÄúNext prompt‚Äù.</p>
      <div id="targetsBox" class="targets"></div>
    </section>

    <!-- Recorder -->
    <section class="card">
      <h3>Record your answer</h3>
      <div class="audio-bar">
        <button id="recBtn">üéôÔ∏è Start</button>
        <button id="stopBtn" class="ghost" disabled>‚èπ Stop</button>
        <span class="timer" id="timer">00:00</span>
        <span id="recStatus" class="status">Mic: idle</span>
        <div class="meter"><div id="meterFill"></div></div>
        <button id="playBtn" class="ghost" disabled>‚ñ∂Ô∏è Play</button>
        <a id="dlLink" class="ghost hidden" download="recording.webm">‚§ì Download</a>
        <audio id="player" class="hidden" controls></audio>
      </div>
    </section>

    <!-- Feedback -->
    <section id="feedback" class="card hidden">
      <h3>Feedback</h3>
      <div class="fb-two">
        <p><strong>What you did well:</strong> <span id="fbGood"></span></p>
        <p><strong>Next step:</strong> <span id="fbNext"></span></p>
        <div class="tag" id="fbCefr"></div>
        <div class="tag mono" id="fbStats"></div>
      </div>
    </section>

    <!-- Actions -->
    <div class="row">
      <div class="pill"><button id="getFbBtn">Get Feedback</button></div>
      <div class="pill"><button id="submitBtn" class="ghost">Submit (to Sheets) ‚Äî not connected</button></div>
      <div class="pill"><button id="clearBtn" class="ghost">Clear</button></div>
    </div>

    <!-- Attempt preview (for copy/paste or later webhook) -->
    <section class="card">
      <details>
        <summary>Attempt data (preview)</summary>
        <pre id="attemptPreview" class="mono">{}</pre>
        <button id="copyBtn" class="ghost">Copy</button>
      </details>
      <p class="sub">Submit button is a placeholder. We‚Äôll wire it to Google Sheets (Make.com / Apps Script) next.</p>
    </section>
  </main>

  <script src="script.js?v=2025-11-03"></script>
</body>
</html>
